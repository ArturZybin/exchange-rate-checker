{"version":3,"sources":["components/CurrencyChart.tsx","App.tsx","index.tsx"],"names":["CurrencyChart","data","base","currency","useEffect","months","i","date","Date","setMonth","getMonth","push","toLocaleString","month","canvas","document","getElementById","Chart","getContext","type","labels","datasets","label","backgroundColor","borderColor","borderWidth","drawChart","id","className","App","useState","currencies","setCurrencies","currencyData","setSecondCurrencyData","fetchCurrencies","then","fetchCurrencyData","baseFullName","currencyFullName","a","fetch","response","ok","console","error","json","fetchPromises","getFetchCurrencyDataPromises","Promise","all","responsesData","forEach","rates","currentDate","toJSON","slice","url","URL","searchParams","set","toString","ReactDOM","render","StrictMode"],"mappings":"wQAUaA,EAAkC,SAAC,GAA8B,IAA5BC,EAA2B,EAA3BA,KAAMC,EAAqB,EAArBA,KAAMC,EAAe,EAAfA,SAa3D,OAZAC,qBAAU,WAGP,IAFA,IAAMC,EAAmB,GAEhBC,EAAI,EAAGA,EAAI,EAAGA,IAAK,CACzB,IAAMC,EAAO,IAAIC,KACjBD,EAAKE,SAASF,EAAKG,WAAaJ,GAChCD,EAAOM,KAAKJ,EAAKK,eAAe,UAAW,CAAEC,MAAO,WAY7D,SAAmBZ,EAAgBC,EAAcC,EAAkBE,GAChE,IAAMS,EAAcC,SAASC,eAAe,SAC5C,IAAKF,EAAQ,OAEb,IAAIG,IAAMH,EAAOI,WAAW,MAAO,CAChCC,KAAM,OACNlB,KAAM,CACHmB,OAAQf,EACRgB,SAAU,CAAC,CACRC,MAAM,GAAD,OAAKnB,EAAL,eAAoBD,GACzBD,OACAsB,gBAAiB,0BACjBC,YAAa,wBACbC,YAAa,OAtBnBC,CAAUzB,EAAMC,EAAMC,EAAUE,KAChC,CAACJ,EAAMC,EAAMC,IAGb,4BAAQwB,GAAG,QAAQC,UAAU,WClB5B,IAAMC,EAAgB,WAAO,IAAD,EACIC,qBADJ,mBACzBC,EADyB,KACbC,EADa,OAERF,mBAAiB,OAFT,mBAEzB5B,EAFyB,aAGA4B,mBAAiB,QAHjB,mBAGzB3B,EAHyB,aAIc2B,sBAJd,mBAIzBG,EAJyB,KAIXC,EAJW,KAOhC9B,qBAAU,Y,2CACP+B,GAAkBC,KAAKJ,KACvB,IAEH5B,qBAAU,Y,8CACPiC,CAAkBnC,EAAMC,GACpBiC,KAAKF,KACT,CAAChC,EAAMC,IAGV,IAAImC,EAAepC,EACfqC,EAAmBpC,EAMvB,OALI4B,IACDO,EAAgBP,EAAqC7B,GACrDqC,EAAoBR,EAAqC5B,IAIzD,yBAAKyB,UAAU,OACZ,kBAAC,EAAD,CACG3B,KAAMgC,EACN/B,KAAMoC,EACNnC,SAAUoC,M,4CAQtB,8BAAAC,EAAA,sEAG0BC,MAAM,qDAHhC,cAGSC,EAHT,QAIiBC,IACXC,QAAQC,MAAM,4BALpB,SAOgBH,EAASI,OAPzB,cAOG7C,EAPH,yBASUA,GATV,4C,kEAaA,WAAiCC,EAAcC,GAA/C,iBAAAqC,EAAA,6DACSP,EAAyB,GAEzBc,EAAgBC,EAA6B9C,EAAMC,GAH5D,SAKS8C,QAAQC,IAAIH,GAAeX,MAAK,SAACe,GACpCA,EAAcC,SAAQ,SAACnD,GAAD,OAAUgC,EAAatB,KAAKV,EAAKoD,MAAMlD,UANnE,gCASU8B,GATV,4C,sBAaA,SAASe,EAA6B9C,EAAcC,GAGjD,IAFA,IAAM4C,EAAgB,GAEbzC,EAAI,EAAGA,EAAI,EAAGA,IAAK,CACzB,IAAMgD,EAAc,IAAI9C,KACxB8C,EAAY7C,SAAS6C,EAAY5C,WAAaJ,GAC9C,IAAMC,EAAO+C,EAAYC,SAASC,MAAM,EAAG,IAErCC,EAAM,IAAIC,IAAI,gDAAkDnD,EAAO,SAC7EkD,EAAIE,aAAaC,IAAI,SAAU,oCAC/BH,EAAIE,aAAaC,IAAI,OAAQ1D,GAC7BuD,EAAIE,aAAaC,IAAI,UAAWzD,GAEhC4C,EAAcpC,KACX8B,MAAMgB,EAAII,YAAYzB,MAAK,SAACM,GAIzB,OAHKA,EAASC,IACXC,QAAQC,MAAM,+BAEVH,EAASI,WAKzB,OAAOC,ECxFVe,IAASC,OACN,kBAAC,IAAMC,WAAP,KACG,kBAAC,EAAD,OAEHjD,SAASC,eAAe,W","file":"static/js/main.d4cfc902.chunk.js","sourcesContent":["import React, { useEffect } from 'react'\nimport Chart from 'chart.js'\n\n\ninterface IProps {\n   data: number[],\n   base: string,\n   currency: string\n}\n\nexport const CurrencyChart: React.FC<IProps> = ({ data, base, currency }) => {\n   useEffect(() => {\n      const months: string[] = []\n\n      for (let i = 0; i < 7; i++) {\n         const date = new Date();\n         date.setMonth(date.getMonth() - i)\n         months.push(date.toLocaleString('default', { month: 'long' }))\n      }\n\n      drawChart(data, base, currency, months)\n   }, [data, base, currency])\n\n   return (\n      <canvas id=\"chart\" className=\"chart\"></canvas>\n   )\n}\n\n\nfunction drawChart(data: number[], base: string, currency: string, months: string[]) {\n   const canvas: any = document.getElementById('chart')\n   if (!canvas) return\n\n   new Chart(canvas.getContext('2d'), {\n      type: 'line',\n      data: {\n         labels: months,\n         datasets: [{\n            label: `${currency} in ${base}`,\n            data,\n            backgroundColor: 'rgba(255, 99, 132, 0.2)',\n            borderColor: 'rgba(255, 99, 132, 1)',\n            borderWidth: 1\n         }]\n      }\n   })\n}","import React, { useState, useEffect } from 'react';\nimport { TCurrencies } from './typescript-types';\n\nimport { CurrencyChart } from './components/CurrencyChart';\n\n\nexport const App: React.FC = () => {\n   const [currencies, setCurrencies] = useState<TCurrencies>()\n   const [base, setBase] = useState<string>('USD')\n   const [currency, setCurrency] = useState<string>('RUB')\n   const [currencyData, setSecondCurrencyData] = useState<number[]>()\n\n\n   useEffect(() => {\n      fetchCurrencies().then(setCurrencies)\n   }, [])\n\n   useEffect(() => {\n      fetchCurrencyData(base, currency)\n         .then(setSecondCurrencyData)\n   }, [base, currency])\n\n\n   let baseFullName = base\n   let currencyFullName = currency\n   if (currencies) {\n      baseFullName = (currencies as {[key: string]: any} )[base]\n      currencyFullName = (currencies as {[key: string]: any} )[currency]\n   }\n\n   return (\n      <div className=\"app\">\n         <CurrencyChart\n            data={currencyData as number[]}\n            base={baseFullName}\n            currency={currencyFullName}\n         />\n      </div>\n   );\n}\n\n\n\nasync function fetchCurrencies() {\n   let data: TCurrencies\n\n   const response = await fetch('https://openexchangerates.org/api/currencies.json')\n   if (!response.ok) {\n      console.error('Error loading currencies')\n   }\n   data = await response.json()\n\n   return data\n}\n\n\nasync function fetchCurrencyData(base: string, currency: string) {\n   const currencyData: number[] = []\n\n   const fetchPromises = getFetchCurrencyDataPromises(base, currency)\n\n   await Promise.all(fetchPromises).then((responsesData) => {\n      responsesData.forEach((data) => currencyData.push(data.rates[currency]))\n   })\n\n   return currencyData\n}\n\n\nfunction getFetchCurrencyDataPromises(base: string, currency: string): Promise<any>[] {\n   const fetchPromises = [] as Promise<any>[]\n\n   for (let i = 0; i < 7; i++) {\n      const currentDate = new Date()\n      currentDate.setMonth(currentDate.getMonth() - i)\n      const date = currentDate.toJSON().slice(0, 10)\n\n      const url = new URL('https://openexchangerates.org/api/historical/' + date + '.json')\n      url.searchParams.set('app_id', '814335798c7149bfb3caad3be6e1acb2')\n      url.searchParams.set('base', base)\n      url.searchParams.set('symbols', currency)\n\n      fetchPromises.push(\n         fetch(url.toString()).then((response) => {\n            if (!response.ok) {\n               console.error('Error loading currency data')\n            }\n            return response.json()\n         })\n      )\n   }\n\n   return fetchPromises\n}","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { App } from './App';\n\nReactDOM.render(\n   <React.StrictMode>\n      <App />\n   </React.StrictMode>,\n   document.getElementById('root')\n);"],"sourceRoot":""}